#!/bin/bash
# ะะฒัะพะผะฐัะธัะตัะบะพะต ะธัะฟัะฐะฒะปะตะฝะธะต ัะฐะทะฒะตัััะฒะฐะฝะธั
echo "๐ง ะัะฟัะฐะฒะปัะตะผ ัะฐะทะฒะตัััะฒะฐะฝะธะต..."

# ะกะพะทะดะฐะตะผ ะบะพะผะฐะฝะดั ะดะปั ะฒัะฟะพะปะฝะตะฝะธั ะฝะฐ ัะตัะฒะตัะต
COMMANDS="
cd /var/www/smilerentalphuket.com/site-smile-rental
echo '๐ ะขะตะบััะฐั ะดะธัะตะบัะพัะธั:'
pwd
echo '๐ ะัะพะฒะตััะตะผ PM2 ััะฐััั:'
pm2 status
echo '๐ ะัะธัะฐะตะผ PM2 ะฟัะพัะตััั:'
pm2 delete all || echo 'ะะตั ะฟัะพัะตััะพะฒ ะดะปั ัะดะฐะปะตะฝะธั'
echo '๐ ะัะพะฒะตััะตะผ package.json:'
ls -la package.json
echo '๐ ะัะพะฒะตััะตะผ .next ะดะธัะตะบัะพัะธั:'
ls -la .next/
echo '๐จ ะะตัะตัะพะฑะธัะฐะตะผ ะฟัะธะปะพะถะตะฝะธะต:'
npm run build
echo '๐ ะะฐะฟััะบะฐะตะผ PM2:'
pm2 start npm --name smile-rental -- start
echo 'โ ะัะพะฒะตััะตะผ ััะฐััั:'
pm2 status
curl -I http://localhost:3000
echo '๐ ะะพัะพะฒะพ!'
"

echo "ะะพะดะบะปััะฐะตะผัั ะบ ัะตัะฒะตัั..."
ssh -o StrictHostKeyChecking=no root@38.180.122.239 "$COMMANDS"
